function actionMessage(response,source){$('#ajax_success').remove();$('#ajax_fail').remove();var message='';if(response==='success'){message=actionSuccessTemplate.replace('_replaceThis_',actionSuccessMessage);}else{actionFailMessage=(context=='ia')?response:actionFailMessage;message=actionFailTemplate.replace('_replaceThis_',actionFailMessage);}
$('.content').prepend(message);$('#ajax_success').effect("highlight",{},300);$('#ajax_fail').effect("highlight",{},300);}
$(document).ready(function(){$(".main-content .content .card.collapsed-card .card-header .card-tools button span").each(function(){if($(this).hasClass("icon-dropdown-open")){$(this).removeClass("icon-dropdown-open");$(this).addClass("icon-dropdown-close");}else{$(this).removeClass("icon-dropdown-close");$(this).addClass("icon-dropdown-open");}});$(".main-content .content .card .card-header a.card-action").click(function(){if($(".main-content .content .card .card-header .card-tools button").find("span").hasClass("icon-dropdown-open")){$(".main-content .content .card .card-header .card-tools button").find("span").removeClass("icon-dropdown-open");$(".main-content .content .card .card-header .card-tools button").find("span").addClass("icon-dropdown-close");}else{$(".main-content .content .card .card-header .card-tools button").find("span").removeClass("icon-dropdown-close");$(".main-content .content .card .card-header .card-tools button").find("span").addClass("icon-dropdown-open");}});$(".main-content .content .card .card-header .card-tools button").click(function(){if($(this).find("span").hasClass("icon-dropdown-open")){$(this).find("span").removeClass("icon-dropdown-open");$(this).find("span").addClass("icon-dropdown-close");}else{$(this).find("span").removeClass("icon-dropdown-close");$(this).find("span").addClass("icon-dropdown-open");}});$(".main-content .content .card .card-body .collapse-action a").click(function(){if($(this).hasClass("collapsed")){$(this).find("span").removeClass("icon-dropdown-close");$(this).find("span").addClass("icon-dropdown-open");}else{$(this).find("span").removeClass("icon-dropdown-open");$(this).find("span").addClass("icon-dropdown-close");}});$(window).bind("resize",function(){if($(window).width()<1024&&context!=='wa'){$(".card.account-card").removeClass("collapsed-card");}else if(context!=='wa'){$(".card.account-card").addClass("collapsed-card");}});$('.sidebar-mini.client-portal.cont-wa .icon.icon-hamburger').on('click',function(e){if($('.sidebar-mini.client-portal.cont-wa').hasClass('sidebar-collapse')){$(".card-body.open-account").removeClass('d-block').addClass('d-none');}else{$(".card-body.open-account").removeClass('d-none').addClass('d-block');}})
var esma=$.cookie('esma_notice');if(esma==1){$('#esmaNoticeModal').modal('show');}
$('#filter_submit').click(function(e){e.preventDefault();var filter_currencies=[];$.each($("#filter_currency option:selected"),function(){filter_currencies.push($(this).val());});var filter_statuses=[];$.each($("#filter_status option:selected"),function(){filter_statuses.push($(this).val());});var filter_types=[];$.each($("#filter_account-type option:selected"),function(){filter_types.push(parseInt($(this).val()));});$('.account-card').each(function(){var hide=false;if(filter_currencies.length>0&&$.inArray($(this).data('accountCurrency'),filter_currencies)===-1){hide=true;}
if(filter_statuses.length>0&&$.inArray($(this).data('accountStatus'),filter_statuses)===-1){hide=true;}
if(filter_types.length>0&&$.inArray($(this).data('accountType'),filter_types)===-1){hide=true;}
if(hide){$(this).hide();}else{$(this).show();}});});$(document).on("click","#btn-reset-ok",function(){$('.modal').modal('hide');var login=$(this).data('mt4_login');$.ajax({url:'/json/reset-mt-password.json',async:false,cache:false,type:"POST",data:{'account':login},success:function(data){console.log(data)
actionMessage(data,'reset-mt-password');},error:function(jqXHR,textStatus,errorThrown){actionMessage('fail','reset-mt-password');}});});$('#modal_mt_reset_password').on('show.bs.modal',function(e){var data=$(e.relatedTarget).data();$('#btn-reset-ok',this).data('mt4_login',data.mt4_login);});$('.trading_report_submit').click(function(e){e.preventDefault();var order=$(this).data('order');var date_from=$('#datepicker_from_'+order).val();var date_to=$('#datepicker_to_'+order).val();var account=$(this).data('account');if(date_from.length>0&&date_to.length>0&&account>0){$.ajax({url:'/json/trading-report.json',async:false,cache:false,type:"GET",data:{'account':account,'from_date':date_from,'to_date':date_to},success:function(data){actionMessage(data,'trading-report');$('#modal_trading_report').modal('show');},error:function(jqXHR,textStatus,errorThrown){actionMessage('fail','trading-report');}});}});});